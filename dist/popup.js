(()=>{"use strict";var e={106:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(d,s){function a(e){try{i(n.next(e))}catch(e){s(e)}}function c(e){try{i(n.throw(e))}catch(e){s(e)}}function i(e){var t;e.done?d(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}i((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.initialize=t.getConfig=t.setDefault=t.CONFIG_VERSION=void 0;const d=o(587);t.CONFIG_VERSION=2;const s={version:t.CONFIG_VERSION,useDesktopNotification:!0,useDiscordNotification:!1,discordWebhookUrl:"",discordMention:"",autoOpenChapterWhenOpenPage:!1,useAutoNext:!0,useAutoNextContainsSupplements:!1,useAutoNextNotGoodOnly:!0,useAutoPauseUnblock:!0,useSeekUnblock:!0,notifyVideoStateChange:!1,discordPlaybackStartedMessage:"%mention% 教材動画 `%title%` の再生を開始しました",discordPlaybackEndedMessage:"%mention% 教材動画 `%title%` の再生が終了しました",discordTakeTestMessage:"%mention% テスト `%title%` を受けてください",desktopPlaybackStarted:"教材動画の再生を開始しました",desktopPlaybackEnded:"教材動画の再生が終了しました",desktopTakeTest:"テストを受けてください",unknownVideo:"不明な動画",unknownTest:"不明なテスト"};function a(){return n(this,void 0,void 0,(function*(){yield chrome.storage.sync.clear(),yield chrome.storage.sync.set(s),(0,d.log)("Config",d.Level.INFO,"Configuration initialized.")}))}function c(){return n(this,void 0,void 0,(function*(){if(0==(yield chrome.storage.sync.getBytesInUse()))(0,d.log)("Config",d.Level.INFO,"Configuration not found, writing default configuration."),yield a();else{let e=yield chrome.storage.sync.get();if(!e.version){(0,d.log)("Config",d.Level.INFO,"Configuration migrate required. You're using config version 1.");const t={version:2,useDesktopNotification:e.useDesktopNotification,useDiscordNotification:e.useDiscordNotification,discordWebhookUrl:e.discordWebhookUrl,discordMention:e.discordMention,autoOpenChapterWhenOpenPage:e.startPlaybackWhenOpenPage,useAutoNext:e.useAutoNext,useAutoNextContainsSupplements:e.useAutoNextContainsSupplements,useAutoNextNotGoodOnly:e.useAutoNextNotGoodOnly,useAutoPauseUnblock:e.useAutoPauseUnblock,useSeekUnblock:e.useSeekUnblock,notifyVideoStateChange:e.notifyVideoStateChange,discordPlaybackStartedMessage:e.discordPlaybackStartedMessage,discordPlaybackEndedMessage:e.discordPlaybackEndedMessage,discordTakeTestMessage:e.discordTakeTestMessage,desktopPlaybackStarted:e.desktopPlaybackStarted,desktopPlaybackEnded:e.desktopPlaybackEnded,desktopTakeTest:e.desktopTakeTest,unknownVideo:e.unknownVideo,unknownTest:e.unknownTest};yield chrome.storage.sync.clear(),yield chrome.storage.sync.set(t)}if(e.version!=s.version){if(2==e.version){let t={version:3,useDesktopNotification:e.useDesktopNotification,useDiscordNotification:e.useDiscordNotification,discordWebhookUrl:e.discordWebhookUrl,discordMention:e.discordMention,autoOpenChapterWhenOpenPage:e.autoOpenChapterWhenOpenPage,useAutoNext:e.useAutoNext,useAutoNextContainsSupplements:e.useAutoNextContainsSupplements,useAutoNextNotGoodOnly:e.useAutoNextNotGoodOnly,useAutoPauseUnblock:e.useAutoPauseUnblock,useSeekUnblock:e.useSeekUnblock,notifyVideoStateChange:e.notifyVideoStateChange,discordPlaybackStartedMessage:e.discordPlaybackStartedMessage,discordPlaybackEndedMessage:e.discordPlaybackEndedMessage,discordTakeTestMessage:e.discordTakeTestMessage,desktopPlaybackStarted:e.desktopPlaybackStarted,desktopPlaybackEnded:e.desktopPlaybackEnded,desktopTakeTest:e.desktopTakeTest,unknownVideo:e.unknownVideo,unknownTest:e.unknownTest};yield chrome.storage.sync.clear(),yield chrome.storage.sync.set(t),e=yield chrome.storage.sync.get()}e.version}}}))}t.setDefault=a,t.getConfig=function(){return n(this,void 0,void 0,(function*(){return yield c(),yield chrome.storage.sync.get()}))},t.initialize=c},587:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.ASCIIColor=t.Level=void 0,t.Level={INFO:"INFO",WARN:"WARN",ERROR:"ERROR",DEBUG:"DEBUG"},t.ASCIIColor={BLACK:"[30m",GRAY:"[90m",DARK_RED:"[31m",RED:"[91m",DARK_GREEN:"[32m",GREEN:"[92m",DARK_YELLOW:"[33m",YELLOW:"[93m",DARK_BLUE:"[34m",BLUE:"[94m",DARK_PURPLE:"[35m",PURPLE:"[95m",DARK_AQUA:"[36m",AQUA:"[96m",DARK_WHITE:"[37m",WHITE:"[97m",RESET:"[0m"},t.log=function(e,o,n){let d=o==t.Level.INFO?t.ASCIIColor.WHITE:o==t.Level.WARN?t.ASCIIColor.DARK_YELLOW:o==t.Level.ERROR?t.ASCIIColor.DARK_RED:t.ASCIIColor.GRAY;console.log(d+"["+new Intl.DateTimeFormat("ja-JP",{timeStyle:"medium"}).format(new Date)+"] ["+e+"] ["+o+"] "+n+t.ASCIIColor.RESET)}}},t={};function o(n){var d=t[n];if(void 0!==d)return d.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,o),s.exports}(()=>{const e=o(587),t=o(106);function n(){(0,t.getConfig)().then((t=>{document.getElementById("auto-open-chapter-when-open-page").checked=t.autoOpenChapterWhenOpenPage,document.getElementById("use-auto-next").checked=t.useAutoNext,document.getElementById("use-auto-next-contains-supplements").checked=t.useAutoNextContainsSupplements,document.getElementById("use-auto-next-not-good-only").checked=t.useAutoNextNotGoodOnly,document.getElementById("use-auto-pause-unblock").checked=t.useAutoPauseUnblock,document.getElementById("use-seek-unblock").checked=t.useSeekUnblock,document.getElementById("notify-video-state-change").checked=t.notifyVideoStateChange,document.getElementById("notify-desktop").checked=t.useDesktopNotification,document.getElementById("notify-discord").checked=t.useDiscordNotification,document.getElementById("discord-webhook-url").value=t.discordWebhookUrl,document.getElementById("discord-mention").value=t.discordMention,document.getElementById("discord-playback-started-message").value=t.discordPlaybackStartedMessage,document.getElementById("discord-playback-ended-message").value=t.discordPlaybackEndedMessage,document.getElementById("discord-take-test-message").value=t.discordTakeTestMessage,document.getElementById("desktop-playback-started").value=t.desktopPlaybackStarted,document.getElementById("desktop-playback-ended").value=t.desktopPlaybackEnded,document.getElementById("desktop-take-test").value=t.desktopTakeTest,document.getElementById("unknown-video").value=t.unknownVideo,document.getElementById("unknown-test").value=t.unknownTest,(0,e.log)("Popup",e.Level.INFO,"Configuration loaded.")}))}window.onload=()=>{n(),document.querySelectorAll("input").forEach((o=>{o.addEventListener("input",(()=>{!function(){const o={version:t.CONFIG_VERSION,autoOpenChapterWhenOpenPage:document.getElementById("auto-open-chapter-when-open-page").checked,useAutoNext:document.getElementById("use-auto-next").checked,useAutoNextContainsSupplements:document.getElementById("use-auto-next-contains-supplements").checked,useAutoNextNotGoodOnly:document.getElementById("use-auto-next-not-good-only").checked,useAutoPauseUnblock:document.getElementById("use-auto-pause-unblock").checked,useSeekUnblock:document.getElementById("use-seek-unblock").checked,notifyVideoStateChange:document.getElementById("notify-video-state-change").checked,useDesktopNotification:document.getElementById("notify-desktop").checked,useDiscordNotification:document.getElementById("notify-discord").checked,discordWebhookUrl:document.getElementById("discord-webhook-url").value,discordMention:document.getElementById("discord-mention").value,discordPlaybackStartedMessage:document.getElementById("discord-playback-started-message").value,discordPlaybackEndedMessage:document.getElementById("discord-playback-ended-message").value,discordTakeTestMessage:document.getElementById("discord-take-test-message").value,desktopPlaybackStarted:document.getElementById("desktop-playback-started").value,desktopPlaybackEnded:document.getElementById("desktop-playback-ended").value,desktopTakeTest:document.getElementById("desktop-take-test").value,unknownVideo:document.getElementById("unknown-video").value,unknownTest:document.getElementById("unknown-test").value};chrome.storage.sync.set(o).then((()=>{(0,e.log)("Popup",e.Level.INFO,"Configuration saved.")}))}(),n()}))})),document.getElementById("reset").onclick=()=>{(0,t.setDefault)().then((()=>{n(),(0,e.log)("Popup",e.Level.INFO,"Configuration reset.")}))}}})()})();